#Область СлужебныеПроцедурыИФункции
// Отправить HTTPЗапрос.
// 
// Параметры:
//  Гиперссылка - Строка - Ссылка сайта
// 
// Возвращаемое значение:
//  HTTPОтвет - Ответ на HTTPЗапрос
Функция ОтправитьHTTPЗапрос(Гиперссылка) Экспорт

	ЗащищенноеСоединение = ?(Найти(Нрег(Гиперссылка), "https://") = 1, Новый ЗащищенноеСоединениеOpenSSL, Неопределено);

	ГиперссылкаБезПротокола = СтрЗаменить(Гиперссылка, "https://", "");
	ГиперссылкаБезПротокола = СтрЗаменить(Гиперссылка, "http://", "");

	Позиция = Найти(ГиперссылкаБезПротокола, "/");

	Если Позиция > 0 Тогда

		Сервер = Лев(ГиперссылкаБезПротокола, Позиция - 1);
		АдресРесурса = Сред(ГиперссылкаБезПротокола, Позиция, СтрДлина(Гиперссылка));

	Иначе

		Сервер = ГиперссылкаБезПротокола;
		АдресРесурса = "/";

	КонецЕсли;

	Сервер = СтрЗаменить(Сервер, "/", ""); //

	HTTPСоединение = Новый HTTPСоединение(Сервер, , , , , 60, ЗащищенноеСоединение);
	HTTPЗапрос = Новый HTTPЗапрос(АдресРесурса);

	Попытка

		HTTPОтвет = HTTPСоединение.Получить(HTTPЗапрос);

	Исключение

		Ошибка = ОбработкаОшибок.ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
		ОтправитьСообщениеВТелеграмм(Справочники.chat_id.Себе.Код, Ошибка);

	КонецПопытки;

	Возврат HTTPОтвет;

КонецФункции

// Отправить сообщение в телеграмм.
// 
// Параметры:
//  chat_id - Строка - ИД чата, для групп ставится дефис вначале
//  Текст - Строка - Текст сообщения
Процедура ОтправитьСообщениеВТелеграмм(chat_id, Текст) Экспорт

	Хост = "https://api.telegram.org";
	Токен = "5428294780:AAEuJw-2ZA2C3ytOWoX4RLS1yjCm6d1RVJY";
	Страница = СтрШаблон("/bot%1/sendMessage?chat_id=%2&text=%3", Хост, Токен, chat_id, Текст);
	ЗащищенноеСоединениеOpenSSL = Новый ЗащищенноеСоединениеOpenSSL;
	HTTPСоединение = Новый HTTPСоединение(Хост, , , , , , ЗащищенноеСоединениеOpenSSL);
	HTTPЗапрос = Новый HTTPЗапрос(Страница);
	HTTPСоединение.Получить(HTTPЗапрос);

КонецПроцедуры
#КонецОбласти
